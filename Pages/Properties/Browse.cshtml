@page
@using RZ_nepremicnine.Models
@model RZ_nepremicnine.Pages.Properties.BrowseModel
@{
    ViewData["Title"] = "Kupi Nepremičnino";
}

<!-- PAGE WRAPPER -->
<div class="container-fluid mt-4">
    <div class="row">

        <!-- LEFT FILTER SIDEBAR -->
        <div class="col-lg-3 col-md-4 mb-4">

            <div class="filter-card p-3 shadow-sm">
                <h5 class="fw-bold mb-3 gradient-text">
                    <i class="bi bi-funnel"></i> Filtri
                </h5>

                <form method="get">
                    <label class="fw-semibold">Regija</label>
                    <select name="SelectedRegion" class="form-select mb-3">
                        <option value="">Vse regije</option>
                        @foreach(var v in Model.Region){
                            <option value="@v" selected="@(Model.SelectedRegion == v)">@v</option>
                        }
                    </select>

                    @* <label class="fw-semibold">Posredovanje</label>
                    <select name="SelectedPosredovanje" class="form-select mb-3">
                        <option value="">Vse vrste</option>
                        @foreach(var v in Model.Posredovanje){
                            <option value="@v" selected="@(Model.SelectedPosredovanje == v)">@v</option>
                        }
                    </select> *@

                    <label class="fw-semibold">Nepremičnina</label>
                    <select name="SelectedVrstaNepremicnine" class="form-select mb-3">
                        <option value="">Vse vrste</option>
                        @foreach(var v in Model.VrstaNepremicnine){
                            <option value="@v" selected="@(Model.SelectedVrstaNepremicnine == v)">@v</option>
                        }
                    </select>

                    <button type="submit" class="btn btn-primary w-100 mb-2">Iskanje</button>
                    <a href="/Properties/Browse" class="btn btn-outline-secondary w-100">Počisti filtre</a>
                </form>
            </div>

        </div>


        <!-- RIGHT CONTENT -->
        <div class="col-lg-9 col-md-8">

            <!-- TITLE -->
            <div class="text-center mb-4">
                <h1><span class="gradient-text">Kupi Nepremičnino</span></h1>
                <p class="text-secondary">Odkrijte našo ponudbo nepremičnin</p>
            </div>

            <!-- ALERT -->
            <div class="alert alert-info">
                <p class="mb-0">Funkcionalnost za pregled nepremičnin je trenutno v razvoju.</p>
            </div>


            <!-- PROPERTY LISTINGS -->
            @if (Model.Nepremicnine != null && Model.Nepremicnine.Any())
            {
                foreach (var Nepremičnina in Model.Nepremicnine)
                {
                    <div class="card shadow-sm mb-4 property-card">
                        <div class="row g-0">

                            <!-- IMAGE -->
                            <div class="col-md-4 d-flex align-items-center justify-content-center">
                                @if (Nepremičnina.Images != null && Nepremičnina.Images.Any())
                                {
                                    <img src="@Nepremičnina.Images.First().ImageUrl"
                                         alt="@Nepremičnina.Naziv"
                                         class="property-thumbnail" />
                                }
                                else
                                {
                                    <div class="property-thumbnail property-thumbnail-placeholder"></div>
                                }
                            </div>

                            <!-- INFO -->
                            <div class="col-md-8 p-4">
                                <h4 class="fw-bold">@Nepremičnina.Naziv</h4>
                                <p class="text-muted mb-1">
                                    @Nepremičnina.Mesto, @Nepremičnina.Regija
                                </p>

                                <div class="property-price mb-2">
                                    €@Nepremičnina.Cena.ToString("N0")
                                </div>

                                <div class="property-features mb-3">
                                    @if (Nepremičnina.Spalnic.HasValue)
                                    {
                                        <span>🛏️ @Nepremičnina.Spalnic Beds</span>
                                    }
                                    @if (Nepremičnina.Kopalnic.HasValue)
                                    {
                                        <span>🚿 @Nepremičnina.Kopalnic Baths</span>
                                    }
                                    @if (Nepremičnina.Kvadratura.HasValue)
                                    {
                                        <span>📏 @Nepremičnina.Kvadratura m²</span>
                                    }
                                </div>

                                <a asp-page="./Details" asp-route-id="@Nepremičnina.Id" class="btn btn-primary">Podrobnosti</a>
                            </div>

                        </div>
                    </div>
                }
            }
            else
            {
                <div class="alert alert-info">
                    <p class="mb-0">Trenutno ni na voljo nobenih nepremičnin.</p>
                </div>
            }

        </div>
    </div>
</div>

<!-- FILTER CSS OVERRIDE -->
<style>
    /* Apply your theme */
    .filter-card {
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
    }

    .filter-card select,
    .filter-card input {
        background: var(--bg-secondary);
        border-radius: 8px !important;
        border: 1px solid var(--border-color);
        padding: .6rem .8rem;
    }

    .property-thumbnail {
        width: calc(100% - 24px);
        height: 210px;
        object-fit: cover;
        border-radius: 12px;
        margin: 12px;
    }

    .property-thumbnail-placeholder {
        background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    }

    .property-price {
        font-size: 1.4rem;
        font-weight: bold;
        color: var(--gradient-end);
    }

    .property-card:hover {
        transform: var(--hover-transform);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15) !important;
    }
</style>